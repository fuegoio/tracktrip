---
import Layout from "../layouts/Layout.astro";
import Badge from "@/components/ui/badge.astro";
import Button from "@/components/ui/button.astro";
import { ArrowRight, Chromium } from "@lucide/astro";
import Header from "@/components/Header.astro";
import CallToAction from "@/components/CallToAction.astro";

import { Image } from "astro:assets";
import mountain from "../assets/mountain.jpg";
import screenshotHome from "../assets/screenshot-home.png";
import screenshotAnalyse from "../assets/screenshot-analyse.png";
import screenshotCategory from "../assets/screenshot-category.png";
import screenshotBudget from "../assets/screenshot-budget.png";
import screenshotBalance from "../assets/screenshot-balance.png";
---

<Layout>
  <main
    class="w-full flex flex-col items-center max-w-[1400px] mx-auto pt-4 gap-4 px-4 overflow-x-hidden xl:overflow-x-visible"
  >
    <section
      class="w-full pt-24 sm:pt-28 p-3 flex flex-col gap-8 pb-8 animate-in fade-in duration-1000 fill-mode-backwards"
    >
      <div class="space-y-4">
        <h1 class="text-5xl sm:text-7xl font-medium">
          Travel better by <br />
          better tracking your expenses.
        </h1>
      </div>

      <div class="text-lg text-muted-foreground w-1/2">
        Tracktrip is a mobile and web app to record and budget your travel
        expenses, solo or with your friends.
      </div>

      <div>
        <div class="flex sm:items-center gap-3 flex-col sm:flex-row">
          <Button
            variant="outline"
            as="a"
            href="https://play.google.com/store/apps/details?id=app.fuegoio.tracktrip"
            target="_blank"
            size="lg"
            class="font-medium"
            data-umami-event="play-store-click"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              shape-rendering="geometricPrecision"
              text-rendering="geometricPrecision"
              image-rendering="optimizeQuality"
              fill-rule="evenodd"
              clip-rule="evenodd"
              viewBox="0 0 466 511.98"
            >
              <g id="Layer_x0020_1">
                <path
                  fill="#EA4335"
                  fill-rule="nonzero"
                  d="M199.9 237.8l-198.5 232.37c7.22,24.57 30.16,41.81 55.8,41.81 11.16,0 20.93,-2.79 29.3,-8.37l0 0 244.16 -139.46 -130.76 -126.35z"
                ></path>
                <path
                  fill="#FBBC04"
                  fill-rule="nonzero"
                  d="M433.91 205.1l0 0 -104.65 -60 -111.61 110.22 113.01 108.83 104.64 -58.6c18.14,-9.77 30.7,-29.3 30.7,-50.23 -1.4,-20.93 -13.95,-40.46 -32.09,-50.22z"
                ></path>
                <path
                  fill="#34A853"
                  fill-rule="nonzero"
                  d="M199.42 273.45l129.85 -128.35 -241.37 -136.73c-8.37,-5.58 -19.54,-8.37 -30.7,-8.37 -26.5,0 -50.22,18.14 -55.8,41.86 0,0 0,0 0,0l198.02 231.59z"
                ></path>
                <path
                  fill="#4285F4"
                  fill-rule="nonzero"
                  d="M1.39 41.86c-1.39,4.18 -1.39,9.77 -1.39,15.34l0 397.64c0,5.57 0,9.76 1.4,15.34l216.27 -214.86 -216.28 -213.46z"
                ></path>
              </g>
            </svg>
            Get in on the Play Store
          </Button>
          <Button
            variant="outline"
            as="a"
            href="https://apps.apple.com/fr/app/tracktrip-travel-expenses/id6756876473"
            target="_blank"
            size="lg"
            class="font-medium"
            data-umami-event="app-store-click"
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 814 1000">
              <path
                d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"
                fill="currentColor"></path>
            </svg>
            Get in on the App Store
          </Button>
          <Button
            variant="outline"
            as="a"
            href="/signup"
            size="lg"
            class="font-medium"
            data-umami-event="get-started-click"
          >
            <Chromium class="size-5" />
            Get started on web
            <ArrowRight class="size-5" />
          </Button>
        </div>
        <div class="flex sm:items-center gap-3 flex-col sm:flex-row mt-2">
          <Button variant="secondary" as="a" href="/docs" size="lg">
            Check documentation
          </Button>
          <div class="text-muted-foreground py-4 text-sm">
            Tracktrip is open-source and free to use.
          </div>
        </div>
      </div>
    </section>

    <section class="relative h-[800px] w-full flex justify-center max-w-full">
      <div
        class="animate-in fade-in duration-1000 absolute -translate-x-2/3 fill-mode-backwards"
      >
        <Image
          src={screenshotHome}
          alt="Screenshot of Tracktrip"
          class="rounded-xl ring-4 ring-white shadow-[0_4px_96px_8px_rgba(0,0,0,0.5)] w-[400px] bg-white skew-x-[25deg] -rotate-[20deg]"
          width="400"
          layout="fixed"
          priority
        />
      </div>
      <div
        class="animate-in fade-in duration-1000 absolute delay-500 fill-mode-backwards"
      >
        <Image
          src={screenshotAnalyse}
          alt="Screenshot of Tracktrip"
          class="rounded-xl ring-4 ring-white shadow-[0_4px_96px_8px_rgba(0,0,0,0.5)] w-[400px] bg-white skew-x-[25deg] -rotate-[20deg]"
          width="400"
          layout="fixed"
          priority
        />
      </div>
      <div
        class="animate-in fade-in duration-1000 absolute translate-x-2/3 delay-1000 fill-mode-backwards"
      >
        <Image
          src={screenshotCategory}
          alt="Screenshot of Tracktrip"
          class="rounded-xl ring-4 ring-white shadow-[0_4px_96px_8px_rgba(0,0,0,0.5)] w-[400px] bg-white skew-x-[25deg] -rotate-[20deg]"
          width="400"
          layout="fixed"
          priority
        />
      </div>
    </section>
  </main>

  <div class="w-full h-[400px] relative overflow-hidden my-20">
    <Image
      src={mountain}
      alt="Mountain"
      class="absolute w-full greyscale top-1/2 transform -translate-y-1/2"
      layout="full-width"
      width="1920"
    />
    <div
      class="w-full max-w-[1400px] mx-auto h-full pt-8 px-12 relative gap-8 flex flex-col justify-center"
    >
      <h2 class="text-5xl text-foreground font-semibold">
        MADE FOR <br />
        MODERN TRAVELLERS
      </h2>

      <div>
        <Button variant="secondary" as="a" href="/why">
          Discover why
          <ArrowRight class="size-5" />
        </Button>
      </div>
    </div>

    <div
      class="absolute top-0 left-0 right-0 h-16 bg-gradient-to-b from-background to-transparent"
    >
    </div>
    <div
      class="absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-background to-transparent"
    >
    </div>
  </div>

  <main
    class="w-full max-w-[1400px] mx-auto pt-8 px-4 space-y-16 sm:space-y-96 sm:pb-32 relative"
  >
    <section
      class="w-full sm:w-1/2 px-4 sm:px-8 space-y-8"
      data-image="screenshotBudget"
    >
      <Header title="Before your trip" desc="Setup your budget easily" />

      <div class="text-muted-foreground">
        Create <span class="text-foreground">budgets</span> for each category of expenses
        and forecast how much you will spend.
      </div>
      <div class="text-muted-foreground">
        Tracktrip offers a simple and opiniated way to set your budget around
        <span class="text-foreground"> 5 expense types </span>.
      </div>

      <Button variant="default" as="a" href="/budget">
        Try our budget calculator without login
      </Button>
      <Button variant="secondary" as="a" href="/docs/budgets">
        Learn about budgets
        <ArrowRight class="size-5" />
      </Button>

      <Image
        src={screenshotBudget}
        alt="Screenshot of budget setting"
        class="sm:hidden rounded-xl ring-4 ring-ring shadow-up-xl w-full"
        layout="constrained"
        width="640"
      />
    </section>

    <section
      class="w-full sm:w-1/2 px-4 sm:px-8 space-y-8"
      data-image="screenshotTransactions"
    >
      <Header
        title="During your trip"
        desc="Track expenses and control your spendings"
      />

      <div class="text-muted-foreground">
        Create
        <span class="text-foreground">transactions</span> seemlessly on the go and
        <span class="text-foreground">analyse</span> your expenses in real time to
        stay within your budget.
      </div>

      <div class="text-muted-foreground">
        You can analyse by
        <a href="/docs/types" class="text-foreground underline">expense type</a
        >,
        <a href="/docs/categories" class="text-foreground underline">category</a
        >, or even by
        <a href="/docs/places" class="text-foreground underline">location</a>.
      </div>

      <Button variant="secondary" as="a" href="/docs/transactions">
        Learn about transactions
        <ArrowRight class="size-5" />
      </Button>

      <Image
        src={screenshotAnalyse}
        alt="Screenshot of analyse"
        class="sm:hidden rounded-xl ring-4 ring-ring shadow-up-xl w-full"
        layout="constrained"
        width="640"
      />
    </section>

    <section
      class="w-full sm:w-1/2 px-4 sm:px-8 space-y-8"
      data-image="screenshotTravellers"
    >
      <Header title="After your trip" desc="Settle the balances and analyse" />

      <div class="text-muted-foreground">
        Review your expenses and settle up with your friends. Analyse your
        spending habits and improve your budgeting for next time.
      </div>

      <Button variant="secondary" as="a" href="/docs/travellers">
        Learn about travellers
        <ArrowRight class="size-5" />
      </Button>

      <Image
        src={screenshotBalance}
        alt="Screenshot of travellers balances"
        class="sm:hidden rounded-xl ring-4 ring-ring shadow-up-xl w-full"
        layout="constrained"
        width="640"
      />
    </section>

    <div
      id="imageContainer"
      class="absolute top-0 right-0 p-8 w-1/2 hidden sm:flex h-full flex-col"
    >
      <div
        id="stickyImageContainer"
        class="sticky top-20 mx-auto max-w-[480px] w-full"
      >
        <Image
          id="imageBudget"
          src={screenshotBudget}
          alt="Screenshot of budget setting"
          class="rounded-xl ring-4 ring-ring shadow-up-xl w-full opacity-100 transition-opacity duration-500"
          width="480"
          layout="constrained"
        />
        <Image
          id="imageTransactions"
          src={screenshotAnalyse}
          alt="Screenshot of analyse"
          class="absolute top-0 rounded-xl ring-4 ring-ring shadow-up-xl w-full opacity-0 transition-opacity duration-500"
          width="480"
          layout="constrained"
        />
        <Image
          id="imageTravellers"
          src={screenshotBalance}
          alt="Screenshot of travellers balances"
          class="absolute top-0 rounded-xl ring-4 ring-ring shadow-up-xl w-full opacity-0 transition-opacity duration-500"
          width="480"
          layout="constrained"
        />
      </div>
      <div id="imageEnd" class="h-px absolute bottom-0"></div>
    </div>
  </main>

  <main
    class="w-full max-w-[1400px] mx-auto pt-8 px-4 space-y-12 pb-32 border-t"
  >
    <section class="w-full flex flex-col items-center px-6 py-16">
      <div class="space-y-4 text-center">
        <h3 class="text-4xl sm:text-6xl font-medium max-w-2xl mx-auto">
          Open-source and transparent
        </h3>
      </div>
      <div
        class="text-lg text-muted-foreground max-w-xl mx-auto text-center mt-4"
      >
        Tracktrip is open-source, privacy-friendly, and transparent. We believe
        in building trust through openness.
      </div>

      <Button as="a" variant="secondary" class="mt-8" href="/transparency">
        Learn about our transparency
        <ArrowRight class="size-4" />
      </Button>
    </section>
  </main>
</Layout>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const sections = document.querySelectorAll("section");

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const imageKey = entry.target.getAttribute("data-image");
            // Hide all images
            document.getElementById("imageBudget").style.opacity = 0;
            document.getElementById("imageTransactions").style.opacity = 0;
            document.getElementById("imageTravellers").style.opacity = 0;

            // Show the correct image
            if (imageKey === "screenshotBudget") {
              document.getElementById("imageBudget").style.opacity = 1;
            } else if (imageKey === "screenshotTransactions") {
              document.getElementById("imageTransactions").style.opacity = 1;
            } else if (imageKey === "screenshotTravellers") {
              document.getElementById("imageTravellers").style.opacity = 1;
            }
          }
        });
      },
      { threshold: 0.5, rootMargin: "0px 0px -50% 0px" },
    );

    sections.forEach((section) => {
      observer.observe(section);
    });

    const lastSection = document.getElementById("imageEnd");
    const stickyContainer = document.getElementById("stickyImageContainer");
    const imageContainer = document.getElementById("imageContainer");
    const endObserver = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          stickyContainer.classList.remove("sticky");
          stickyContainer.classList.remove("top-20");
          imageContainer.classList.add("justify-end");
          stickyContainer.classList.add("relative");
        } else {
          stickyContainer.classList.add("sticky");
          stickyContainer.classList.add("top-20");
          imageContainer.classList.remove("justify-end");
          stickyContainer.classList.remove("relative");
        }
      },
      { threshold: 0.0 },
    );

    endObserver.observe(lastSection);
  });
</script>
